---
title: "ESG indicators"
subtitle: "An Analysis of availability"
author: ""
date: "`r Sys.Date()`"
output:
  tufte::tufte_html: default
  tufte::tufte_handout:
    citation_package: natbib
    latex_engine: xelatex
  tufte::tufte_book:
    citation_package: natbib
    latex_engine: xelatex
bibliography: 
link-citations: yes
---

```{r setup, echo=FALSE, message=FALSE, warning=FALSE}
pkg <-
  c(
    "devtools",
    "tidyverse",
    "data.table", 
    "ggplot2",
    "treemapify", 
    "magrittr", 
    "tufte"
  )
new.pkg <-
  pkg[!(pkg %in% installed.packages()[, "Package"])] # check installed packages
load.pkg <-
  pkg[!(pkg %in% loadedNamespaces())]              # check loaded packages

if (length(new.pkg)) {
  install.packages(new.pkg)     # Install missing packages
}

if (length(load.pkg)) {
  lapp <- lapply(load.pkg, library, character.only = TRUE) # load all packages
}

knitr::opts_chunk$set(tidy = FALSE, cache.extra = packageVersion('tufte'))
options(htmltools.dir.version = FALSE)

#knitr::opts_knit$set(root.dir = "D:/R working directory/")
```


```{r loadData, echo=FALSE, message=FALSE, warning=FALSE}
esg2 <- read.csv("data/ESG.csv")
esg <- read_csv("data/ESG.csv")
esg <- esg %>% rename_at(vars(contains(" ")),
                  ~str_replace(., " ", "_")) %>% 
  rename_all(tolower) 

#names(esg) %<>% tolower

```
## Introduction

The paper aims at providing an overview of the indicators curated and disseminated by World Bank and relevant for ESG (Environmental, Social, Governance) investment. The work has been conducted assembling a metadata database on indicators, doing a series of interviews with data managers and analyzing and researching the set of indicators and their metadata. We identified 123 indicators of relevance to ESG investments and we provide in the following parts of the paper an analytical overview of these indicators. We start first with a detailed overview of the methodology used to analyze the dataset and we continue with providing a set of insights on sources, processing entities and dissemination of these indicators and the frequency of their updates and release. 

# Methodology 
The 123 indicators identified as relevant for ESG investment come from World Bank databases, mainly from the World Development Indicators database. In order to have a complete picture of the indicators, we assembled a database for analysis consisting of indicators metadata with a total of 34 variables. The 34 variables were meant to provide the most comprehensive overview of each indicator separately. We tracked each indicator by a unique code assigned to it, by database of which it is part of, by name, topic, statistical methodology used for compilation, aggregation methods, its relevance to development, periodicity , collecting, processing, and disseminating entity among others. Among these 34 variables, we identified a set of 17 variables that contain most of the information that is relevant for the analysis of these indicators in the context of their use in ESG investments. These 17 variables had set out to capture the indicator’s code and name, the database they belong to, the collecting, processing and dissemination entity, the granularity of data (monthly, yearly etc) and the shortest gap between release date and most recent data point available. Finally, we tried to capture the statistical methods through which the indicators are created and to capture imputations performed on the dataset. The annex of this paper provides an overview of the initial database of the indicators metadata and the short version with the variables of most interest to this paper. 
In order to fill in knowledge gaps in metadata, a set of 8 interviews have been conducted with internal Point of Consultation (PoC), data managers with extensive knowledge of each indicator of interest. The interviews took place over a three week period, in person and over phone and focused mostly on frequency update and release. With the help of these interviews, we were able to fill in the metadata database with relevant information on the timelines and update processes of these indicators. Finally, we created an additional variable called “subject” in order to classify each indicators under a broader category: Environmental, Social and Governance. Assigning indicators to Environmental and Social category was generally straightforward as we used the definition provided in the World Bank Group publication of April 2018, Incorporating Environmental, Social and Governance (ESG) Factors into Fixed Income Investment. Thus, environmental indicators are related to climate change, carbon emissions, pollution, resource efficiency and biodiversity. Social indicators pertain to human rights, labor standards, health and safety, diversity policies, development of human capital (health & education). Finally, governance indicators refer to corporate governance issues, corruption, rule of law, institutional strength and transparency. A series of indicators such as GNI per capita, government expenditure on education, gross national savings have been assigned to the governance category due to their close relationship to governance related outcomes. The level of such indicators are closely correlated to governance related issues. Finally, using the database assembled on the abovementioned guidelines we were able to analyze the metadata of indicators and provide insights on key issues such as update frequency and dissemination, processing methods, data handling techniques and perceived quality of indicators. 

# Database description 
The final database assembled for analysis had a total of 35 variables for a total of 123 indicators. The indicators came grouped in 10 different database identification numbers. 38 indicators were designed as environmental indicators, 37 governance indicators and 48 social indicators. We have identified 41 subcategories grouped under topic where more details about the topic to which the indicators belong are provided. 


# Data Management

```{r internal_poc, fig.margin = TRUE, echo = FALSE, fig.width = 4.5, fig.asp = .75, fig.cap = "Indicators per manager"}
esg %>% count(internal_poc) %>% 
  ggplot(aes(area = n, fill = internal_poc, 
             label = paste(internal_poc, "\n", n))) +
  geom_treemap(
    color = "white", size = .75*.pt,
    layout = "fixed",show.legend = FALSE
  ) +
  geom_treemap_text(
    colour = "black", place = "centre",
    grow = FALSE,
    layout = "fixed"
  )  

```

Most of the indicators of interest to ESG work are handled by Wendy - 33, followed by Florina - 24, Hiroko 23, Haruna 17 and Bhaskar 14. Almost 80% of indicators are managed by 4 people, Wendy, Florina, Hiroko and Haruna. Most of the indicators currently handled by Wendy will be managed by the analyst working on environmental indicators that joined DECDG in July 2019.

# Unavailable data

```{r freqna, fig.margin = TRUE, echo = FALSE, fig.width = 4.5, fig.asp = .75, fig.cap = "Not Available Indicators"}
esg %>% count(`highest_frequency - production`) %>% 
  ggplot(aes(area = n, fill = `highest_frequency - production`, 
             label = paste(`highest_frequency - production`, "\n", n))) +
  geom_treemap(
    color = "white", size = .75*.pt,
    layout = "fixed", 
    show.legend = FALSE
  ) +
  geom_treemap_text(
    colour = "black", place = "centre",
    grow = FALSE,
    layout = "fixed", 
    min.size = 3
  )  

```

About 21% of all indicators---26 out of 123---come as Not Available for one of the following reasons: 
1. Data no longer updated by the source and prepared migration to a different one;
2. Data was used one time only; 
3. Indicators are not managed by the indicated point of consultation or they are no in the WDI database;
4. Someone else is managing the indicators and indicators are decommissioned. 

Thus, a total of 97 indicators enter the final analysis. 

# ESG indicators broken down

```{r subject, fig.margin = TRUE, echo = FALSE, fig.width = 4.5, fig.asp = .75, fig.cap = "Class of indicators"}
esg %>% count(subject) %>% 
  ggplot(aes(area = n, fill = subject, 
             label = paste(subject, "\n", n))) +
  geom_treemap(
    color = "white", size = .75*.pt,
    layout = "fixed",show.legend = FALSE
  ) +
  geom_treemap_text(
    colour = "black", place = "centre",
    grow = FALSE,
    layout = "fixed"
  )  

```

Most of the indicators, 48, are classified as social indicators, followed by 38 environmental and 37 governance indicators. The process of assigning indicators followed an analysis of the descirption of indicators found in the metadata by name and cassigned category. Indicators such as those related to debt, tax, growth and GDP are grouped under governance indicators as one can argue that their evolution is a function of the governance structures in the specific countries. 

```{r topic, fig.margin = TRUE, echo = FALSE, fig.width = 4.5, fig.asp = .75, fig.cap = "Topic description"}
esg2 %>% count(Topic) %>% 
  ggplot(aes(area = n, fill = Topic, 
             label = paste(Topic, "\n", n))) +
  geom_treemap(
    color = "white", size = .75*.pt,
    layout = "fixed",show.legend = FALSE
  ) +
  geom_treemap_text(
    colour = "black", place = "centre",
    grow = FALSE,
    layout = "fixed"
  )  

```

The assignment of indicators to ESG categories was performed by analyzing the Topic column of the indicators metadata. 29 indicators are related to Environment; 21 to health; 13 to Economic Policy and Debt; 12 to Infrastructure and 11 to Social Protection. 14 indicators are grouped under the category other. 

# Data collection

```{r collecting entity, fig.margin = TRUE, echo = FALSE, fig.width = 5.5, fig.asp = 1, fig.cap = "Collecting Entity Type"}
counts <- table(esg2$SOURCE1..NSO.IO.ITP.ET.) 
barplot(counts, main="Collecting Entity") 
```

68 out of 97 indicators updated on a continuous basis are collected by International Organizations, while 16 and 10 indicators are collected by Internal Third Parties and External Third Parties respectively. A small number of indicators, 3, are collected by a consortium of IO, ITP and ETP

# Data processing
66 out of 97 indicators updated on a continuous basis are processed by IO, while 21 are processed by Internal Third Parties and 10 by Extrernal Third Parties. 

```{r procent, fig.margin = TRUE, echo = FALSE, fig.width = 5.5, fig.asp = 1, fig.cap = "Processing Entity Type"}
counts <- table(esg2$SOURCE2) 
barplot(counts, main="Processing Entity")
```

66 indicators out of 97 updated continuosly are disseminated by IO, 21 by ITP and 10 by ETP

```{r dissent, fig.margin = TRUE, echo = FALSE, fig.width = 5.5, fig.asp = 1, fig.cap = "Dissemination entity"}
counts <- table(esg2$SOURCE3) 
barplot(counts, main="Dissemination Entity")
```

Most of indicators, 75, are produced on an annual basis. 8 indicators are updated quarterly and 7 every other year. The remaining 7 indicators are produced on a equartelry, montly or every three years basis. 


```{r prodfre, fig.margin = TRUE, echo = FALSE, fig.width = 5.5, fig.asp = 1, fig.cap = "Production frequency"}
  counts <- table(esg2$Highest.Frequency...Production) 
  barplot(counts, main="Production Frequency") 
```


```{r upfre, fig.margin = TRUE, echo = FALSE, fig.width = 5.5, fig.asp = 1, fig.cap = "Update frequency"}
  counts <- table(esg2$Highest.Frequency...Update.frequency) 
  barplot(counts, main="Update freqency") 
```
   

53 indicators have a unique source instrument only (e.g. source type), most of them 32 being sourced from third party sources (TPS) while 9 each are sourced from surveys (S) and administrative records. The rest of the indicators are sourced from a combination of 2,3 or 4 different source types. 

```{r sourcinstr, fig.margin = TRUE, echo = FALSE, fig.width = 5.5, fig.asp = 1, fig.cap = "Update frequency"}
  counts <- table(esg2$Source.Instrument) 
  barplot(counts, main="Source Instr") 
```
   
There are only four indicators for which imputation methods are used to fill in gaps. Three of them are managed by Emi and pertain to populational indicators and one by Bhaskar, GNI per capita. 


```{r imput, fig.margin = TRUE, echo = FALSE, fig.width = 5.5, fig.asp = 1, fig.cap = "Imputation"}
  counts <- table(esg2$Imputed.Data.) 
  barplot(counts, main="Imputation") 
```

32 indicators come with notes related to issues such as last year available, updates, discontinuation etc. 

```{r notes, fig.margin = TRUE, echo = FALSE, fig.width = 5.5, fig.asp = 1, fig.cap = "Notes"}
  counts <- table(esg2$Notes) 
  barplot(counts, main="Notes") 
```

Need to color and reorder bar charts 

Need stacked Bar charts to provide insights for indicators based on their assigned subject, environmental, social or governance.  

New update
